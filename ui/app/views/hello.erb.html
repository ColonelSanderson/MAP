<% if agency %>
  <div class="card">
    <div class="card-content">
      <span class="card-title"><%= agency.label %> - <%= location.name %></span>
      <table>
        <thead>
          <tr>
            <th>Record</th>
            <th></th>
            <th>QSA Identifier</th>
            <th>Representations</th>
          </tr>
        </thead>
        <tbody>
          <% agency.controlled_records.each do |record| %>
            <tr>
              <td><%= record['title'] %></td>
              <td><%= record['end_date'] ? 'under movement' : '' %></td>
              <td><%= record['type'] + ' ' + record['qsa_id'] %></td>
              <td>
                <%=
                ['physical', 'digital']
                .map {|rep_type| Array(record["#{rep_type}_representations"]).count.to_s + " #{rep_type}" }
                .join('; ')
                %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
<% else %>
      <div class="card">
        <div class="card-content">
          <span class="card-title">No controlled records</span>
          <p>Your agency does not currently control any records.</p>
        </div>
      </div>
<% end %>
